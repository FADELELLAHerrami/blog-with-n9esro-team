import n from"events";import e from"util";import t from"stream";import r from"process";import i from"buffer";var u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var a={};var f=i.Buffer;var o=r;var c=n.EventEmitter;var l=e;var s=t;function Lazy(n,e){if(!((this||u)instanceof Lazy))return new Lazy(n,e);c.call(this||u);var t=this||u;t.once=function(n,e){t.on(n,(function g(){t.removeListener(n,g);e.apply(this||u,arguments)}))};e||(e={});var r=e.data||"data";var i=e.pipe||"pipe";var a=e.pipe||"end";if(i!=a){var o=false;t.once(i,(function(){o=true}));t.once(a,(function(){o||t.emit(i)}))}t.push=function(n){t.emit(r,n)};t.end=function(){t.emit(a)};if(n&&n.on){n.on(a,(function(){t.emit(a)}));t.on(i,(function(){n.emit(i)}));s.Duplex&&n instanceof s?n.on("readable",(function(){var e=n.read();t.emit(r,e)})):n.on(r,(function(n){t.emit(r,n)}))}function newLazy(n,u,a){n||(n=function(){return true});u||(u=function(n){return n});var f=new Lazy(null,e,a);t.on(r,(function(e,t){n.call(f,e)&&f.emit(r,u(e),t)}));t.once(i,(function(){f.emit(i)}));return f}t.filter=function(n){return newLazy((function(e){return n(e)}))};t.forEach=function(n){return newLazy((function(e){n(e);return true}))};t.map=function(n){return newLazy((function(){return true}),(function(e){return n(e)}))};t.head=function(n){var e=newLazy();e.on(r,(function g(t){n(t);e.removeListener(r,g)}))};t.tail=function(){var n=true;return newLazy((function(){if(n){n=false;return false}return true}))};t.skip=function(n){return newLazy((function(){if(n>0){n--;return false}return true}))};t.take=function(n){return newLazy((function(){0==n&&t.emit(i);return n-- >0}))};t.takeWhile=function(n){var e=true;return newLazy((function(r){if(e&&n(r))return true;e=false;t.emit(i);return false}))};t.foldr=function(n,e,t){var u=e;var a=newLazy();a.on(r,(function g(e){u=n(e,u)}));a.once(i,(function(){t(u)}))};t.sum=function(n){return t.foldr((function(n,e){return n+e}),0,n)};t.product=function(n){return t.foldr((function(n,e){return n*e}),1,n)};t.join=function(n){var e=[];var r=newLazy((function(n){e.push(n);return true}));r.once(i,(function(){n(e)}));return t};t.bucket=function(n,u){var f=new Lazy(null,e);var yieldTo=function(n){f.emit(r,n)};var o=n;t.on(r,(function(n){o=u.call(yieldTo,o,n)}));t.once(i,(function(){f.emit(i)}));t.once(a,(function(){var n=v(o);n&&yieldTo(n)}));return f};t.__defineGetter__("lines",(function(){return t.bucket([],(function(n,e){var t="\n".charCodeAt(0),r=0;"string"===typeof e&&(e=new f(e));if(e)for(var i=0;i<e.length;i++)if(e[i]===t){i>0&&n.push(e.slice(r,i));(this||u)(v(n));r=i+1}r>0?r<e.length&&n.push(e.slice(r)):e&&e.length&&n.push(e);return n}))}))}Lazy.range=function(){var n=arguments;var e=1;var t=false;if(1==n.length&&"number"==typeof n[0])var r=0,i=n[0];else if(1==n.length&&"string"==typeof n[0]){var u=n[0];var a=false,f=false;if("("==u[0]||"["==u[0]){"("==u[0]&&(a=true);u=u.slice(1)}"]"==u.slice(-1)&&(f=true);var c=u.split("..");if(2!=c.length)throw new Error("single argument range takes 'start..' or 'start..end' or 'start,next..end'");if(""==c[1]){var r=c[0];t=true}else{var l=c[0].split(",");if(1==l.length)var r=c[0],i=c[1];else{var r=l[0],i=c[1];e=Math.abs(l[1]-r)}}r=parseInt(r,10);i=parseInt(i,10);a&&(t||r<i?r++:r--);f&&(r<i?i++:i--)}else{if(2!=n.length&&3!=n.length)throw new Error("range takes 1, 2 or 3 arguments");var r=n[0],i=n[1];if(3==n.length)var e=n[2]}var s=new Lazy;var v=false;s.on("pipe",(function(){v=true}));t?o.nextTick((function g(){if(!v){s.emit("data",r++);o.nextTick(g)}})):o.nextTick((function(){if(r<i)for(;r<i;r+=e)s.emit("data",r);else for(;r>i;r-=e)s.emit("data",r);s.emit("end")}));return s};var v=function mergeBuffers(n){if(n&&Array.isArray(n)&&n.length){var e,t,r,i=0;e=n.reduce((function(n,e){return(n.length||n)+(e.length||e)}),0);t=new f(e);while(n.length){r=n.shift();r.copy(t,i);i+=r.length}return t}};l.inherits(Lazy,c);a=Lazy;var h=a;export default h;

