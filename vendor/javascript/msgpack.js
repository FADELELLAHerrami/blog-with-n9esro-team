import e from"buffer";import t from"events";import a from"util";import r from"sys";var n=null;throw new Error('Unable to resolve "./../build/Release/msgpackBinding" from npm:msgpack@1.0.3/lib/msgpack.js');var f;var l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var u={};var i=e;var o=t;var p;p=n;var b;try{b=a}catch(e){b=r}var c=p.pack;var s=p.unpack;u.pack=pack;u.unpack=s;function pack(){var e=arguments,t,a;for(a=0;a<arguments.length;a++){t=e[a];t&&"object"===typeof t&&"function"===typeof t.toJSON&&(e[a]=t.toJSON())}return c.apply(null,e)}var Stream=function(e){var t=this||l;o.EventEmitter.call(t);t.buf=null;t.send=function(t){var a=[pack(t)];for(l.i=f=1;f<arguments.length;f++)a.push(arguments[f]);return e.write.apply(e,a)};e.addListener("data",(function(e){if(t.buf){var a=new i.Buffer(t.buf.length+e.length);t.buf.copy(a,0,0,t.buf.length);e.copy(a,t.buf.length,0,e.length);t.buf=a}else t.buf=e;while(t.buf&&t.buf.length>0){var r=s(t.buf);if(!r)break;t.emit("msg",r);s.bytes_remaining>0?t.buf=t.buf.slice(t.buf.length-s.bytes_remaining,t.buf.length):t.buf=null}}))};b.inherits(Stream,o.EventEmitter);u.Stream=Stream;const m=u.pack,g=u.unpack,v=u.Stream;export default u;export{v as Stream,m as pack,g as unpack};

